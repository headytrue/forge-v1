<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FORGE â€” Free AI Image Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --bg: #080808;
    --surface: #111;
    --border: #1e1e1e;
    --accent: #ff3c00;
    --accent2: #ff9100;
    --text: #f0ede6;
    --muted: #444;
  }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Space Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(255,60,0,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255,60,0,0.03) 1px, transparent 1px);
    background-size: 44px 44px;
    z-index: 0; pointer-events: none;
  }
  .wrap {
    position: relative; z-index: 1;
    max-width: 860px; margin: 0 auto;
    padding: 40px 20px 80px;
  }

  /* HEADER */
  header { text-align: center; margin-bottom: 44px; }
  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(70px, 18vw, 130px);
    line-height: 1;
    background: linear-gradient(135deg, var(--accent) 30%, var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 8px;
    filter: drop-shadow(0 0 50px rgba(255,60,0,0.35));
    animation: pulse 4s ease-in-out infinite;
  }
  @keyframes pulse { 0%,100%{filter:drop-shadow(0 0 50px rgba(255,60,0,0.35))} 50%{filter:drop-shadow(0 0 80px rgba(255,145,0,0.5))} }
  .tagline { color: var(--muted); font-size: 10px; letter-spacing: 5px; text-transform: uppercase; margin-top: 6px; }
  .free-badge {
    display: inline-block;
    border: 1px solid rgba(255,145,0,0.4);
    color: var(--accent2);
    font-size: 9px; letter-spacing: 3px;
    padding: 4px 12px; margin-top: 10px;
    text-transform: uppercase;
  }

  /* INFO */
  .info {
    background: rgba(255,60,0,0.05);
    border: 1px solid rgba(255,60,0,0.15);
    border-left: 3px solid var(--accent);
    padding: 14px 18px;
    font-size: 10px; color: rgba(240,237,230,0.6);
    letter-spacing: 0.5px; line-height: 1.8;
    margin-bottom: 28px;
  }
  .info strong { color: var(--accent2); }

  /* SECTION LABEL */
  .lbl {
    font-size: 9px; letter-spacing: 3px;
    color: var(--muted); text-transform: uppercase;
    margin-bottom: 10px;
    display: flex; align-items: center; gap: 8px;
  }
  .lbl::after { content: ''; flex: 1; height: 1px; background: var(--border); }

  /* MODEL GRID */
  .model-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(155px, 1fr));
    gap: 8px; margin-bottom: 24px;
  }
  .mc {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 11px 13px;
    cursor: pointer; transition: all 0.15s;
    position: relative; overflow: hidden;
  }
  .mc::before {
    content: ''; position: absolute;
    left: 0; top: 0; bottom: 0; width: 0;
    background: var(--accent);
    transition: width 0.2s;
  }
  .mc.active::before { width: 3px; }
  .mc:hover { border-color: var(--muted); transform: translateY(-1px); }
  .mc.active { border-color: rgba(255,60,0,0.5); background: rgba(255,60,0,0.04); }
  .mc-name { font-size: 11px; font-weight: 700; margin-bottom: 3px; }
  .mc-desc { font-size: 9px; color: var(--muted); line-height: 1.4; }
  .mc-tag { font-size: 8px; color: var(--accent2); margin-top: 5px; letter-spacing: 1px; }
  .mc-check { position: absolute; top: 8px; right: 9px; font-size: 10px; color: var(--accent); display: none; }
  .mc.active .mc-check { display: block; }

  /* PROMPT */
  .prompt-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    margin-bottom: 14px;
    transition: border-color 0.2s;
  }
  .prompt-wrap:focus-within { border-color: rgba(255,60,0,0.5); }
  #prompt {
    width: 100%; background: transparent; border: none;
    color: var(--text); font-family: 'Space Mono', monospace;
    font-size: 13px; line-height: 1.7; padding: 16px;
    resize: none; outline: none; min-height: 95px;
  }
  #prompt::placeholder { color: var(--muted); }
  .prompt-footer {
    display: flex; align-items: center; justify-content: space-between;
    padding: 8px 14px; border-top: 1px solid var(--border);
  }
  .neg-btn {
    background: none; border: none; font-family: 'Space Mono', monospace;
    font-size: 9px; letter-spacing: 1px; color: var(--muted);
    cursor: pointer; transition: color 0.15s; text-transform: uppercase;
  }
  .neg-btn:hover { color: var(--accent2); }
  .char-count { font-size: 9px; color: var(--muted); }

  #neg-wrap { display: none; margin-bottom: 14px; }
  #neg-prompt {
    width: 100%; background: var(--surface);
    border: 1px solid var(--border);
    border-top: 1px dashed rgba(255,60,0,0.2);
    color: rgba(240,237,230,0.6); font-family: 'Space Mono', monospace;
    font-size: 11px; padding: 12px 16px;
    resize: none; outline: none; min-height: 55px;
  }
  #neg-prompt::placeholder { color: var(--muted); }

  /* SETTINGS */
  .settings { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 24px; }
  @media(max-width:560px){ .settings{ grid-template-columns:1fr 1fr; } }
  .sg label { display: block; font-size: 9px; letter-spacing: 2px; color: var(--muted); text-transform: uppercase; margin-bottom: 7px; }
  .sg select {
    width: 100%; background: var(--surface); border: 1px solid var(--border);
    color: var(--text); font-family: 'Space Mono', monospace;
    font-size: 10px; padding: 9px 10px; outline: none; cursor: pointer;
    transition: border-color 0.15s;
  }
  .sg select:focus { border-color: rgba(255,60,0,0.5); }
  .sg select option { background: #111; }

  /* SEED */
  .seed-row { display: flex; gap: 8px; align-items: center; margin-bottom: 24px; }
  #seed-input {
    flex: 1; background: var(--surface); border: 1px solid var(--border);
    color: var(--text); font-family: 'Space Mono', monospace;
    font-size: 11px; padding: 9px 12px; outline: none;
  }
  #seed-input:focus { border-color: rgba(255,60,0,0.4); }
  .rand-btn {
    background: transparent; border: 1px solid var(--border);
    color: var(--muted); font-family: 'Space Mono', monospace;
    font-size: 9px; letter-spacing: 1px; padding: 9px 14px;
    cursor: pointer; text-transform: uppercase; transition: all 0.15s;
    white-space: nowrap;
  }
  .rand-btn:hover { border-color: var(--accent2); color: var(--accent2); }

  /* GENERATE BTN */
  .gen-btn {
    width: 100%; background: var(--accent); color: #fff;
    border: none; font-family: 'Bebas Neue', sans-serif;
    font-size: 26px; letter-spacing: 5px; padding: 16px;
    cursor: pointer; position: relative; overflow: hidden;
    transition: all 0.2s; margin-bottom: 8px;
  }
  .gen-btn::after {
    content: ''; position: absolute;
    top: 0; left: -100%; width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
    transition: left 0.4s;
  }
  .gen-btn:hover::after { left: 100%; }
  .gen-btn:hover { background: var(--accent2); box-shadow: 0 0 40px rgba(255,60,0,0.4); transform: translateY(-1px); }
  .gen-btn:active { transform: translateY(0); }
  .gen-btn:disabled { background: #222; color: var(--muted); cursor: not-allowed; transform: none; box-shadow: none; }
  .gen-hint { text-align: center; font-size: 9px; color: var(--muted); letter-spacing: 2px; margin-bottom: 28px; text-transform: uppercase; }

  /* PROGRESS */
  .prog-wrap { height: 2px; background: var(--border); margin-bottom: 24px; display: none; }
  .prog-bar { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); width: 0%; transition: width 0.5s ease; }

  /* STATUS */
  .status { text-align: center; font-size: 11px; color: var(--muted); min-height: 22px; margin-bottom: 20px; letter-spacing: 1px; }
  .status.loading { color: var(--accent); animation: blink 0.9s infinite; }
  .status.error { color: #ff4444; font-size: 12px; letter-spacing: 0; }
  .status.ok { color: #44ff88; }
  @keyframes blink { 0%,100%{opacity:1}50%{opacity:0.2} }

  /* OUTPUT */
  .out-section { display: none; }
  .out-section.on { display: block; }
  .out-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .out-wrap {
    background: var(--surface); border: 1px solid var(--border);
    min-height: 280px; display: flex; align-items: center; justify-content: center;
    overflow: hidden; position: relative;
  }
  #out-img {
    max-width: 100%; display: block;
    animation: appear 0.5s ease;
  }
  @keyframes appear { from{opacity:0;transform:scale(0.97)}to{opacity:1;transform:scale(1)} }
  .out-overlay {
    position: absolute; bottom: 0; left: 0; right: 0;
    background: linear-gradient(transparent, rgba(0,0,0,0.7));
    padding: 20px 16px 12px;
    font-size: 9px; color: rgba(240,237,230,0.5);
    letter-spacing: 0.5px; line-height: 1.5;
    display: none;
  }
  .out-wrap:hover .out-overlay { display: block; }
  .dl-btn {
    background: transparent; border: 1px solid var(--accent);
    color: var(--accent); font-family: 'Space Mono', monospace;
    font-size: 9px; letter-spacing: 2px; padding: 8px 16px;
    cursor: pointer; text-transform: uppercase; transition: all 0.15s;
    text-decoration: none; display: inline-block;
  }
  .dl-btn:hover { background: var(--accent); color: #fff; }

  /* HISTORY */
  .hist-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(88px, 1fr));
    gap: 6px; margin-top: 18px;
  }
  .hi { position: relative; overflow: hidden; }
  .hi img {
    width: 100%; aspect-ratio: 1; object-fit: cover;
    display: block; border: 1px solid var(--border);
    cursor: pointer; transition: all 0.15s;
  }
  .hi img:hover { border-color: var(--accent); transform: scale(1.02); }
</style>
</head>
<body>
<div class="wrap">

  <header>
    <div class="logo">FORGE</div>
    <p class="tagline">AI Image Generator</p>
    <span class="free-badge">âœ¦ 100% FREE â€” NO API KEY NEEDED</span>
  </header>

  <div class="info">
    âš¡ Powered by <strong>Pollinations.AI</strong> â€” completely free, no sign up, no limits, no CORS issues.<br>
    ðŸ–¥ This is a <strong>single HTML file</strong> â€” host it FREE on <strong>GitHub Pages</strong> or just open it in your browser. No server needed.
  </div>

  <!-- MODEL -->
  <div class="lbl">Model</div>
  <div class="model-grid">
    <div class="mc" data-model="flux">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">FLUX</div>
      <div class="mc-desc">Best quality, highly detailed. Top choice overall.</div>
      <div class="mc-tag">âš¡ BEST QUALITY</div>
    </div>
    <div class="mc active" data-model="flux-realism">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">FLUX Realism</div>
      <div class="mc-desc">Real humans, skin texture, photorealistic portraits.</div>
      <div class="mc-tag">ðŸ‘¤ REAL PEOPLE</div>
    </div>
    <div class="mc" data-model="flux-anime">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">FLUX Anime</div>
      <div class="mc-desc">Anime style characters, stylized scenes.</div>
      <div class="mc-tag">ðŸŽŒ ANIME</div>
    </div>
    <div class="mc" data-model="flux-3d">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">FLUX 3D</div>
      <div class="mc-desc">3D rendered look. Cinematic scenes & environments.</div>
      <div class="mc-tag">ðŸŽ¬ 3D / CINEMA</div>
    </div>
    <div class="mc" data-model="turbo">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">Turbo</div>
      <div class="mc-desc">Very fast generation. Great for quick tests.</div>
      <div class="mc-tag">âš¡ FAST</div>
    </div>
    <div class="mc" data-model="flux-pro">
      <span class="mc-check">âœ“</span>
      <div class="mc-name">FLUX Pro</div>
      <div class="mc-desc">Higher resolution, ultra detailed output.</div>
      <div class="mc-tag">ðŸ”¥ HIGH RES</div>
    </div>
  </div>

  <!-- PROMPT -->
  <div class="lbl">Prompt</div>
  <div class="prompt-wrap">
    <textarea id="prompt" rows="4"
      placeholder="Describe your scene in detail â€” lighting, camera angle, mood, style, colors, time of day..."
      oninput="document.getElementById('cc').textContent=this.value.length"></textarea>
    <div class="prompt-footer">
      <button class="neg-btn" onclick="toggleNeg()">ï¼‹ Negative prompt</button>
      <span class="char-count" id="cc">0</span>
    </div>
  </div>
  <div id="neg-wrap">
    <textarea id="neg-prompt" rows="2"
      placeholder="What to avoid: bad anatomy, blurry, watermark, ugly, distorted, low quality..."></textarea>
  </div>

  <!-- SETTINGS -->
  <div class="lbl">Settings</div>
  <div class="settings">
    <div class="sg">
      <label>Width</label>
      <select id="w">
        <option value="512">512px</option>
        <option value="768" selected>768px</option>
        <option value="1024">1024px</option>
        <option value="1280">1280px</option>
      </select>
    </div>
    <div class="sg">
      <label>Height</label>
      <select id="h">
        <option value="512">512px</option>
        <option value="768" selected>768px</option>
        <option value="1024">1024px</option>
        <option value="1280">1280px</option>
      </select>
    </div>
    <div class="sg">
      <label>Enhance</label>
      <select id="enhance">
        <option value="false">Off</option>
        <option value="true">On (auto-improve prompt)</option>
      </select>
    </div>
  </div>

  <!-- SEED -->
  <div class="lbl">Seed (same seed = same result)</div>
  <div class="seed-row">
    <input type="number" id="seed-input" placeholder="Random" />
    <button class="rand-btn" onclick="randomSeed()">ðŸŽ² Random</button>
    <button class="rand-btn" onclick="document.getElementById('seed-input').value=''">Clear</button>
  </div>

  <!-- BUTTON -->
  <button class="gen-btn" id="gen-btn" onclick="generate()">GENERATE IMAGE</button>
  <p class="gen-hint">Ctrl + Enter to generate</p>

  <div class="prog-wrap" id="pw"><div class="prog-bar" id="pb"></div></div>
  <div class="status" id="status"></div>

  <!-- OUTPUT -->
  <div class="out-section" id="out">
    <div class="out-header">
      <div class="lbl" style="margin:0">Output</div>
      <a class="dl-btn" id="dl-btn" download="forge.jpg" target="_blank">â¬‡ Download</a>
    </div>
    <div class="out-wrap">
      <img id="out-img" src="" alt="Generated image" />
      <div class="out-overlay" id="prompt-overlay"></div>
    </div>
    <div class="hist-grid" id="hist"></div>
  </div>

</div>

<script>
  let model = 'flux-realism';
  const history = [];

  // Model selection
  document.querySelectorAll('.mc').forEach(c => {
    c.addEventListener('click', () => {
      document.querySelectorAll('.mc').forEach(x => x.classList.remove('active'));
      c.classList.add('active');
      model = c.dataset.model;
    });
  });

  function toggleNeg() {
    const w = document.getElementById('neg-wrap');
    w.style.display = w.style.display === 'block' ? 'none' : 'block';
  }

  function randomSeed() {
    document.getElementById('seed-input').value = Math.floor(Math.random() * 999999999);
  }

  function setStatus(msg, type='') {
    const s = document.getElementById('status');
    s.textContent = msg;
    s.className = 'status ' + type;
  }

  let progInt;
  function startProg() {
    document.getElementById('pw').style.display = 'block';
    let v = 0;
    progInt = setInterval(() => {
      v += Math.random() * 4;
      if (v > 88) v = 88;
      const pct = v + '%';
      document.getElementById('pb').style.width = pct;
    }, 500);
  }
  function endProg() {
    clearInterval(progInt);
    document.getElementById('pb').style.width = '100%';
    setTimeout(() => {
      document.getElementById('pw').style.display = 'none';
      document.getElementById('pb').style.width = '0%';
    }, 400);
  }

  async function generate() {
    const prompt = document.getElementById('prompt').value.trim();
    if (!prompt) { setStatus('âš  Enter a prompt first', 'error'); return; }

    const w = document.getElementById('w').value;
    const h = document.getElementById('h').value;
    const enhance = document.getElementById('enhance').value;
    const seedVal = document.getElementById('seed-input').value.trim();
    const neg = document.getElementById('neg-prompt').value.trim();

    const seed = seedVal ? parseInt(seedVal) : Math.floor(Math.random() * 999999999);
    if (!seedVal) document.getElementById('seed-input').value = seed;

    const btn = document.getElementById('gen-btn');
    btn.disabled = true;
    startProg();

    // Build Pollinations URL
    const encoded = encodeURIComponent(prompt);
    let url = `https://image.pollinations.ai/prompt/${encoded}?model=${model}&width=${w}&height=${h}&seed=${seed}&nologo=true&enhance=${enhance}`;
    if (neg) url += `&negative_prompt=${encodeURIComponent(neg)}`;

    // Show live elapsed timer so user knows it's working (not frozen)
    let elapsed = 0;
    setStatus(`Generating... 0s`, 'loading');
    const timer = setInterval(() => {
      elapsed++;
      setStatus(`Generating with ${model}... ${elapsed}s`, 'loading');
    }, 1000);

    try {
      // Use fetch with no timeout â€” let it run as long as needed (up to 90s)
      const controller = new AbortController();
      const hardTimeout = setTimeout(() => controller.abort(), 90000); // 90s max

      const res = await fetch(url, { signal: controller.signal });
      clearTimeout(hardTimeout);
      clearInterval(timer);

      if (!res.ok) {
        throw new Error(`Server returned ${res.status}`);
      }

      // Convert response to blob then to object URL
      const blob = await res.blob();
      const objectUrl = URL.createObjectURL(blob);

      endProg();
      const outImg = document.getElementById('out-img');
      outImg.src = objectUrl;
      document.getElementById('dl-btn').href = objectUrl;
      document.getElementById('dl-btn').download = `forge-${seed}.jpg`;
      document.getElementById('prompt-overlay').textContent = `"${prompt}"`;
      document.getElementById('out').classList.add('on');
      history.unshift({ url: objectUrl, prompt, seed });
      renderHist();
      setStatus(`âœ“ Done in ${elapsed}s!  Seed: ${seed} â€” save to recreate this image`, 'ok');

    } catch (err) {
      clearInterval(timer);
      endProg();
      if (err.name === 'AbortError') {
        setStatus('Timed out after 90s â€” Pollinations is overloaded, try again in a moment', 'error');
      } else {
        setStatus(`Error: ${err.message} â€” try again or pick a different model`, 'error');
      }
    }

    btn.disabled = false;
  }

  function renderHist() {
    document.getElementById('hist').innerHTML = history.slice(0, 15).map((x, i) =>
      `<div class="hi"><img src="${x.url}" title="${x.prompt} [seed:${x.seed}]" onclick="showHist(${i})" loading="lazy"/></div>`
    ).join('');
  }

  function showHist(i) {
    document.getElementById('out-img').src = history[i].url;
    document.getElementById('dl-btn').href = history[i].url;
    document.getElementById('prompt-overlay').textContent = `"${history[i].prompt}"`;
    document.getElementById('seed-input').value = history[i].seed;
    setStatus(`Viewing: seed ${history[i].seed}`, 'ok');
    window.scrollTo({ top: document.getElementById('out').offsetTop - 20, behavior: 'smooth' });
  }

  document.addEventListener('keydown', e => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') generate();
  });
</script>
</body>
</html>
